(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const p=20,h=14,g=30,m=[[[1,1],[1,1]],[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,0],[1,1],[0,1]],[[0,1],[1,1],[1,0]],[[1,0],[1,0],[1,1]],[[0,1],[0,1],[1,1]]];function C(e,o){const t=Array(o-1).fill(0).map(()=>Array(e).fill(0)),n=Array(e).fill(1);return n[6]=0,n[7]=0,t.push(n),t}function d(e,o){return o.shape.some((t,n)=>t.some((r,i)=>{var a;const l=(a=e[o.position.y+n])==null?void 0:a[o.position.x+i];return l===void 0?!0:l===1&&r===1}))}function P(e){const o=structuredClone(e),t=[];return o.forEach((n,r)=>{n.every(i=>i===1)&&t.push(r)}),t.forEach(n=>{o.splice(n,1);const r=Array(h).fill(0);o.unshift(r)}),o}function R(e,o){const t=structuredClone(e);return o.shape.forEach((n,r)=>{n.forEach((i,l)=>{var a;i===1&&((a=e[r+o.position.y])==null?void 0:a[l+o.position.x])!==void 0&&(t[r+o.position.y][l+o.position.x]=1)})}),o.shape=m[Math.floor(Math.random()*m.length)],o.position.x=h/2,o.position.y=0,d(e,o)&&(t.forEach(n=>n.fill(0)),window.alert("Ha ha")),{board:t,piece:o}}function E(e,o){let t=structuredClone(o),n=structuredClone(e);if(t.position.y++,!d(e,t))o.position=t.position;else{const r=R(n,o);n=r.board,t=r.piece,n=P(n)}return{board:n,piece:t}}function v(e,o){const t=structuredClone(o);return t.position.x--,d(e,t)||(o.position=t.position),o}function x(e,o){const t=structuredClone(o);return t.position.x++,d(e,t)||(o.position=t.position),o}function L(e,o){const t=structuredClone(o),n=[];for(let r=0;r<o.shape[0].length;r++){const i=[];for(let l=o.shape.length-1;l>=0;l--)i.push(o.shape[l][r]);n.push(i)}return t.shape=n,d(e,t)||(o.shape=t.shape),t}const f=document.querySelector("canvas"),c=f==null?void 0:f.getContext("2d");f!==null&&(f.width=p*h,f.height=p*g);c!=null&&c.scale(p,p);let u=C(h,g),s={position:{x:5,y:7},shape:[[1,1],[1,1]]},y=0,w=0;function A(e=0){O();const o=e-w;if(w=e,y+=o,y>1e3){const t=E(u,s);s=t.piece,u=t.board,y=0}window.requestAnimationFrame(A)}function O(){c&&f&&(c.fillStyle="#ccc",c.fillRect(0,0,f.width,f.height),u.forEach((e,o)=>{e.forEach((t,n)=>{t===1&&(c.fillStyle="yellow",c.fillRect(n,o,1,1))})}),s.shape.forEach((e,o)=>{e.forEach((t,n)=>{t===1&&(c.fillStyle="red",c.fillRect(s.position.x+n,s.position.y+o,1,1))})}))}window.document.addEventListener("keydown",function(e){if(console.log(e),e.key==="ArrowLeft"){const o=v(u,s);s.position=o.position,s.shape=o.shape}if(e.key==="ArrowRight"){const o=x(u,s);s.position=o.position,s.shape=o.shape}if(e.key==="ArrowDown"){const o=E(u,s);u=o.board,s=o.piece}e.key==="ArrowUp"&&L(u,s)});A();
